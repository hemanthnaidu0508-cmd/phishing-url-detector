<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Phishing URL Detection Tool</title>

    <!-- Spring Boot static CSS -->
    <link rel="stylesheet" href="/style.css">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<div class="container">

    <header class="header">
        <h1>üîê Phishing URL Detection</h1>
        <p class="subtitle">Analyze URLs for phishing & security risks</p>
    </header>

    <main class="card">
        <form id="scanForm">
            <input
                    type="url"
                    id="urlInput"
                    placeholder="https://example.com"
                    required
            />
            <button type="submit">üöÄ Scan URL</button>
        </form>

        <div id="loading" class="hidden">
            <div class="spinner"></div>
            <p>Scanning URL...</p>
        </div>

        <div id="result"></div>
    </main>

    <footer class="footer">
        Built with <strong>Spring Boot</strong> ‚Ä¢ Security Analysis Tool
    </footer>

</div>

<script>
    const form = document.getElementById("scanForm");
    const loading = document.getElementById("loading");
    const result = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const url = document.getElementById("urlInput").value;
        result.innerHTML = "";
        loading.classList.remove("hidden");

        try {
            const response = await fetch("/api/scan", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ url })
            });

            const data = await response.json();
            loading.classList.add("hidden");

            if (response.ok) {
                result.innerHTML = `
                    <div class="result ${data.riskLevel === 'SAFE' ? 'safe' : 'phishing'}">
                        <h3>‚úÖ Scan Result</h3>
                        <p><strong>Risk:</strong> ${data.riskLevel}</p>
                        <p>${data.message}</p>
                    </div>
                `;
            } else {
                result.innerHTML = `
                    <div class="result phishing">
                        <h3>‚ùå Error</h3>
                        <p>${data.message || "Something went wrong"}</p>
                    </div>
                `;
            }

        } catch (err) {
            loading.classList.add("hidden");
            result.innerHTML = `
                <div class="result phishing">
                    <h3>‚ùå Server Error</h3>
                    <p>Please try again later</p>
                </div>
            `;
        }
    });
</script>

</body>
</html>
